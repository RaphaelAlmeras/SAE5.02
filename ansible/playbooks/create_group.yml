---
- name: Créer un groupe Linux et ajouter des utilisateurs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Créer le groupe Linux
      group:
        name: "{{ group_name }}"
        state: present

    - name: Ajouter les utilisateurs au groupe
      user:
        name: "{{ item }}"
        groups: "{{ group_name }}"
        append: yes
      # On force la conversion de la chaîne JSON en liste ici :
      loop: "{{ users_to_add | from_json }}"
