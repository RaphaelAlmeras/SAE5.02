---
- name: Créer un groupe Linux et ajouter des utilisateurs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Créer le groupe Linux
      group:
        name: "{{ group_name }}"
        state: present

    - name: Ajouter les utilisateurs au groupe
      user:
        name: "{{ item | trim }}"
        groups: "{{ group_name }}"
        append: yes
      # On découpe la chaîne par les virgules et on boucle sur le résultat
      loop: "{{ users_to_add.split(',') }}"
      when: users_to_add | length > 0
